---
import type { CollectionEntry } from 'astro:content'
import { slugifyPost, sortPosts } from '../utils'

export interface Props {
	posts: CollectionEntry<'posts'>[]
}

const { posts } = Astro.props

const allPostsSorted = sortPosts(posts)
---

<dl>
	{
		allPostsSorted.map((post) => (
			<div>
				<dt>
					<time datetime={post.data.date.toISOString().slice(0, 10)}>
						{post.data.date.toLocaleDateString('en-gb', {
							weekday: 'short',
							year: 'numeric',
							month: 'short',
							day: '2-digit',
						})}
					</time>
					{post.data.draft && <span class="draft-marker"> draft</span>}
				</dt>
				<dd>
					<a href={import.meta.env.BASE_URL + slugifyPost(post)}>
						{post.data.title}
					</a>
				</dd>
			</div>
		))
	}
</dl>

<style>
	dl {
		/* Autosizing grid columns CSS is adapted from https://css-tricks.com/look-ma-no-media-queries-responsive-layouts-using-css-grid/#aa-the-article-list */
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(min(12rem, 100%), 1fr));
		gap: calc(1rem + 1.25vw);
		margin-top: 1.75rem;
	}
	dl a {
		text-decoration: none;
	}
	dl a:hover {
		text-decoration: underline;
	}
	.draft-marker {
		text-transform: uppercase;
		font-size: 0.6667em;
		background: var(--colour3);
		border: 1px solid var(--nav-text);
		border-radius: 0.125em;
		padding-inline: 0.25em;
		margin-inline-start: 0.25em;
		vertical-align: 0.125em;
	}
</style>
